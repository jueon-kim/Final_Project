<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>글목록</title>
    <!-- 부트스트랩 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- 부트스트랩 아이콘 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

    <!-- 다음 지도-->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=bf290bec6b7de30eb3c7f533f6f6720a&libraries=services"></script>
    <!-- 다음 주소검색 -->
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>


</head>
<body>

<div th:include="/views/header.html"></div>

    <section style="width: 1400px; margin: auto; justify-content: center">

        <div th:each="detail : ${postDetail}">

        <div style="width: 100%; height: 500px;">
            <input type="hidden" class="postNum" th:value="${post.post_num}">
            <img src="" alt="" width="640px" height="500px;">
            <div style="width: 640px; height: 500px; float: right;">

                <div style="width: 604px; height:200px; margin: auto;">
                    <ul style="list-style: none; margin-top: 20px;">
                        <li style="display: inline-block;">
                            <p>제품상태 > </p>
                        </li>
                        <li style="display: inline-block;">
                            <p>거래방식 > </p>
                        </li>

                        <li style="display: inline-block;">
                            <p>배송비</p>
                        </li>

                        <li>
                            <h1 th:text="${detail.post_title}"></h1>
                        </li>
                        <li>
                            <p style="font-size: 30px;" th:text="${detail.post_price}"></p>
                        </li>
                    </ul>
                </div>
                <span id="regdate" th:text="${detail.post_regdate}"></span> · <span>조회 26</span> · <span>찜 0</span>
                <div style="width: 604px; height:100px; margin: auto;">
                    <ul style="list-style: none;">
                        <li style="display: inline-block; text-align: center">
                            <p>제품상태</p>
                            <p style="font-size: 18px;" th:text="${detail.post_productState}"></p>
                        </li>

                        <li style="display: inline-block; padding: 15px; text-align: center">
                            <p>거래방식</p>
                            <p style="font-size: 18px;" th:text="${detail.post_way}"></p>
                        </li>

                        <li style="display: inline-block; padding: 15px; text-align: center">
                            <p>희망 거래지역</p>
                            <p style="font-size: 18px;" th:text="${detail.post_location}"></p>
                        </li>

                        <li style="display: inline-block; padding: 15px; text-align: center">
                            <p>조회수</p>
                            <p style="font-size: 18px;">7,267</p>
                        </li>

                    </ul>
                </div>

                <div style="width: 604px; height: 100px; margin: auto;">
                    <div style="text-align: center; display: flex; margin-top: 20px;">
                        <div style="text-align: center; justify-content: center">
                            <i onclick="likeProc()" style="font-size: 40px; margin-left: 50px;" class="bi bi-heart"></i>
                        </div>

                        <div style="display: flex; margin: auto">
                            <button style="width: 200px; height: 50px; background-color: transparent;" type="submit">채팅하기</button>
                            <button style="width: 200px; height: 50px; margin-left: 10px; background-color: transparent;" type="submit">
                                <a style="text-decoration: white">채팅하기</a>
                            </button>
                        </div>
                    </div>
                </div>

            </div>


        <div style="width: 300px; height: 300px;">
            <div th:text="${detail.post_content}"><div>
        </div>

        </div>
    </section>

<script th:inline="javascript">
    /*

        var heartBtn = document.getElementById("likeBtn");

        heartBtn.addEventListener("click", function() {

        });
    */

    const likeProc = (button) => {
        const postNum = document.getElementsByClassName('postNum').value;
        console.log(postNum);

        $.ajax({
            type:"post",
            url:"/like",
            data:{
                "postNum":postNum
            },
            success:function (res){
                console.log(res.postNum);
                console.log(res.userNum);
                console.log(res.likeNum);
                /*
                let isLiked = ;
                if(isLiked){

                }else{

                }
                */
            },
            error:function (err){
                console.log(err)
            }
        });

    }
</script>







<script>
    function formatDate(dateString) {
        const now = new Date();
        const date = new Date(dateString);
        const diff = now - date;
        const minutes = Math.floor(diff / (1000 * 60));
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const months = Math.floor(diff / (1000 * 60 * 60 * 24 * 30));

        if (minutes < 60) {
            return minutes + '분 전';
        } else if (hours < 24) {
            return hours + '시간 전';
        } else if (days < 30) {
            return days + '일 전';
        } else {
            return months + '달 전';
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        const regdateElements = document.querySelectorAll('#regdate');

        regdateElements.forEach(function(element) {
            var regdate = element.textContent;
            // 날짜 형식 변환 함수 호출
            var formattedDate = formatDate(regdate);
            element.textContent = formattedDate;
        });
    });
</script>



<!-- 제이쿼리 3.6.3 --><!-- 제이쿼리 3.6.3 -->
<script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>

<!-- 파퍼 1.12.9 -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

<!-- 부트스트랩 5.3.2 자바스크립트 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-element-bundle.min.js"></script>

</body>
</html>